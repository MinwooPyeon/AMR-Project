# SARS(Safety AMR System) AI 시스템

## 📖 프로젝트 개요

웹캠을 기반으로 물류공장에서 발생할 수 있는 위험 상황을 감지하고 발생 시 MQTT 통신을 통해 AMR에서 서버로 알림을 전송하는 시스템입니다.


## ✨ 주요 기능

* **AMR 자율주행:** 모든 AMR 최신 상태 조회 및 개별 AMR 상세 정보 조회
* **위험 상황 탐지:** AMR에서 AI를 통해 발생한 위험 상황(예: 사람 쓰러짐)을 감지
* **알림 전송:** MQTT를 통해 AMR에서 서버로 알림 전송


## 🛠️ 기술 스택
- **Python**
- **Pytorch**
- **OpenCV**
- **Ultralytics**
- **ROS2**
- **MQTT**


## 🤔 문제 정의 및 목표 (Problem Definition & Goal)

* **문제**: 물류 공장 내에서 발생할 수 있는 잠재적 위험 상황(안전 장비 미착용, 물류 붕괴, 흡연, 작업자 쓰러짐 등)을 감지하는 체계 부재
* **목표**: 웹캠을 통해 실시간으로 영상을 분석하고, 위험 상황이 감지되면 즉시 서버로 알림을 전송하여 신속한 대응을 가능하게 합니다.


## 📊 데이터 및 전처리 (Data & Preprocessing)

* **데이터 소스**: AI-hub의 **물류창고 내 작업 안전 데이터**를 활용했습니다. 약 30,000장의 이미지를 포함하며, 다양한 작업자와 장비의 객체가 라벨링되어 있습니다.
* **전처리 과정**:
    * 기존 데이터의 레이블을 다음 4가지 핵심 레이블로 재매핑했습니다.
        * `NOT_WEAR_WORKER`: 안전 장비를 착용하지 않은 작업자
        * `MATERIAL_COLLAPSE`: 적재된 물류가 붕괴되는 상황
        * `SMOKE_VIOLATION`: 금연 구역에서의 흡연
        * `PERSON_FALL`: 쓰러진 작업자
    * 매핑된 레이블에 맞게 각 이미지에 대한 JSON 파일을 생성했습니다.

## 🧠 모델 설계 및 개발 (Model Design & Development)

* **접근 방식**: 객체 탐지 모델인 **YOLO**를 학습시켜 각 위험 상황을 감지하도록 했습니다.
* **모델/알고리즘**:
    * **객체 탐지**: 사전에 학습된 **YOLOv8m** 모델을 전처리된 데이터셋으로 **파인튜닝(Fine-tuning)**하여 사용했습니다.
    * **쓰러짐 감지**: **YOLOv11n-pose** 모델을 활용해 사람의 키포인트(keypoint)를 탐지하고, 키포인트 위치를 계산하여 쓰러짐을 감지했습니다.

## 📈 결과 및 성과 (Results & Achievements)

* **정량적 성과**:
    * 각 객체 및 위험 상황 클래스에 대해 **mAP50-95 기준 90% 이상**의 높은 감지 정확도를 달성했습니다.
    * **성능 테이블**:

| Class | Images | Instances | P | R | mAP50 | mAP50-95 |
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
| all | 4172 | 29165 | 0.991 | 0.990 | 0.994 | 0.968 |
| HANDLING\_EQUIPMENT | 2969 | 4520 | 0.987 | 0.993 | 0.993 | 0.970 |
| INDIVIDUAL\_MATERIAL | 3789 | 16443 | 0.987 | 0.993 | 0.994 | 0.976 |
| MATERIAL\_COLLAPSE | 96 | 796 | 0.996 | 0.998 | 0.994 | 0.925 |
| NOT\_WEAR\_WORKER | 936 | 1401 | 0.998 | 0.999 | 0.995 | 0.984 |
| STACKED\_MATERIAL | 1274 | 2456 | 0.991 | 0.967 | 0.994 | 0.985 |
| WEAR\_WORKER | 3158 | 3378 | 0.989 | 0.991 | 0.994 | 0.969 |

* **정성적 성과**: 학습된 모델로 실제 시연했을 때 안전 장비 미착용 및 쓰러짐 감지 기능이 성공적으로 작동하는 것을 확인했습니다.

    * 안전장비 미착용 탐지
    ![안전장비 미착용](/images/작업복장.png)
    * 쓰러진 작업자 탐지
    ![쓰러진 작업자](/images/사람%20쓰러진거.png)